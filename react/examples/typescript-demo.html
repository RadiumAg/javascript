<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TypeScript React 示例</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        #app {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            min-height: 400px;
        }
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            font-size: 18px;
            color: #666;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="loading">正在加载 TypeScript React 应用...</div>
    </div>

    <!-- 使用编译后的JavaScript文件 -->
    <script type="module">
        // 导入编译后的模块
        import { createElement, useState, useEffect } from './dist/index.js';
        import { createRoot } from './dist/react-dom/index.js';

        // 定义计数器组件
        function Counter({ initialValue = 0, title = "计数器" }) {
            const [count, setCount] = useState(initialValue);
            const [isEven, setIsEven] = useState(count % 2 === 0);

            useEffect(() => {
                setIsEven(count % 2 === 0);
                console.log(`Count changed to: ${count}`);
            }, [count]);

            const increment = () => setCount(prev => prev + 1);
            const decrement = () => setCount(prev => prev - 1);
            const reset = () => setCount(initialValue);

            return createElement('div', {
                style: {
                    padding: '20px',
                    border: '1px solid #ccc',
                    borderRadius: '8px',
                    margin: '10px',
                    backgroundColor: isEven ? '#f0f8ff' : '#fff8f0'
                }
            }, [
                createElement('h2', { key: 'title' }, title),
                createElement('p', { key: 'display' }, `当前计数: ${count} (${isEven ? '偶数' : '奇数'})`),
                createElement('div', { key: 'buttons' }, [
                    createElement('button', {
                        key: 'inc',
                        onClick: increment,
                        style: { margin: '5px', padding: '5px 10px', cursor: 'pointer' }
                    }, '+1'),
                    createElement('button', {
                        key: 'dec',
                        onClick: decrement,
                        style: { margin: '5px', padding: '5px 10px', cursor: 'pointer' }
                    }, '-1'),
                    createElement('button', {
                        key: 'reset',
                        onClick: reset,
                        style: { margin: '5px', padding: '5px 10px', cursor: 'pointer' }
                    }, '重置')
                ])
            ]);
        }

        // 应用组件
        function App() {
            const [showSecondCounter, setShowSecondCounter] = useState(false);

            return createElement('div', {
                style: {
                    fontFamily: 'Arial, sans-serif',
                    maxWidth: '600px',
                    margin: '0 auto',
                    padding: '20px'
                }
            }, [
                createElement('h1', { key: 'header' }, 'TypeScript React 示例'),
                createElement('p', { key: 'description' }, '这是一个使用 TypeScript 编写的简易 React 应用示例。'),
                
                // 第一个计数器
                createElement(Counter, { 
                    key: 'counter1',
                    initialValue: 5,
                    title: '主计数器'
                }),
                
                // 切换按钮
                createElement('button', {
                    key: 'toggle',
                    onClick: () => setShowSecondCounter(prev => !prev),
                    style: {
                        margin: '20px 0',
                        padding: '10px 20px',
                        backgroundColor: '#007bff',
                        color: 'white',
                        border: 'none',
                        borderRadius: '5px',
                        cursor: 'pointer'
                    }
                }, showSecondCounter ? '隐藏第二个计数器' : '显示第二个计数器'),
                
                // 条件渲染第二个计数器
                showSecondCounter && createElement(Counter, {
                    key: 'counter2',
                    initialValue: 10,
                    title: '次计数器'
                })
            ]);
        }

        // 渲染应用
        console.log('TypeScript React 应用启动中...');
        try {
            const container = document.getElementById('app');
            if (container) {
                const root = createRoot(container);
                root.render(createElement(App));
                console.log('应用已渲染到 DOM');
            } else {
                console.error('未找到 #app 容器元素');
            }
        } catch (error) {
            console.error('应用启动失败:', error);
            document.getElementById('app').innerHTML = `
                <div style="padding: 20px; color: red; text-align: center;">
                    <h2>应用启动失败</h2>
                    <p>请检查控制台获取详细错误信息</p>
                    <pre>${error.message}</pre>
                </div>
            `;
        }
    </script>
</body>
</html>